"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[161],{4161:(e,t,i)=>{i.r(t),i.d(t,{default:()=>g});var o=i(5043),n=i(9748),s=i(2019),l=i(1686),r=i(1766),c=i(1118),d=i(5010),a=i(3188),u=i(184),p=i(6468),x=i(3768),m=i(3307),h=i(579);const g=e=>{let{onclose:t,setSelectedProducts:i,selectedProducts:g}=e;const[f]=n.A.useForm(),[v,y]=(0,o.useState)([]),[j,b]=(0,o.useState)(!0),[w,A]=(0,o.useState)(!1),[z,S]=(0,o.useState)({}),[C,k]=(0,o.useState)(!1),[$,F]=(0,o.useState)("shop"),[N,P]=(0,o.useState)([]),[R,q]=(0,o.useState)(!1),[I,E]=(0,o.useState)(window.innerWidth);(0,o.useEffect)((()=>{const e=()=>{E(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,o.useEffect)((()=>{(async()=>{try{const{data:e}=await p.t$.get(`/products/?category=${$}&is_paginated=false`,{headers:{Authorization:`Token ${localStorage.getItem("token")}`}});0===e.length&&((0,x.Ay)("No product available. Try adding products."),t()),y(null===e||void 0===e?void 0:e.message)}catch(e){y([]),console.error("Failed to fetch products:",e),s.Ay.error("Failed to load products.")}finally{b(!1)}})()}),[t,$]),(0,o.useEffect)((()=>{(async()=>{if(z.product_id){console.log(z);try{var e;const t=await p.t$.get(`/customize/${z.product_id}/`),i=(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.message)||[];console.log(i),i.length>0?P(i):P([])}catch(t){console.log(t)}}})()}),[R]);(0,o.useRef)(null);const _=(0,o.useRef)(null),D=(0,o.useRef)(null),T=(0,o.useRef)(null);return(0,h.jsxs)("div",{className:m.A.invoicepopup,children:[(0,h.jsx)("div",{className:"text-end m-3",children:(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px"},children:[(0,h.jsxs)("select",{onChange:e=>F(e.target.value),className:m.A.customSelect,children:[(0,h.jsx)("option",{value:"shop",children:"Shop"}),(0,h.jsx)("option",{value:"order",children:"Order"}),(0,h.jsx)("option",{value:"combo",children:"Combo"})]}),(0,h.jsx)(u.QCr,{onClick:t,style:{fontSize:"28px",cursor:"pointer",color:"red"}})]})}),j?(0,h.jsxs)("div",{style:{textAlign:"center",padding:"20px"},children:[(0,h.jsx)(l.A,{size:"large"}),(0,h.jsx)("p",{children:"Loading products..."})]}):(0,h.jsxs)("div",{style:{padding:"10px",background:"white",display:"flex",flexDirection:"row",height:"100vh"},children:[(0,h.jsx)("div",{className:`col-8 col-md-8 col-xl-9 ${m.A.rmscroll}`,style:{display:"flex",flexWrap:"wrap",gap:"20px",justifyContent:"center",height:"inherit",overflowY:"auto"},children:v.map((e=>(0,h.jsxs)("div",{className:m.A.withoutselectedProducts,onClick:()=>(e=>{var t;k(!1),S(e),A(!0),null===(t=_.current)||void 0===t||t.focus(),f.setFieldsValue({count:1,customize:"",price:e.price}),q((e=>!e))})(e),style:{width:"150px",textAlign:"center",padding:"12px",gap:"0",cursor:"pointer",border:"1px solid #f0f0f0",borderRadius:"8px",height:"250px",boxShadow:"1px 1px  #cbcdce"},children:[(0,h.jsx)("img",{style:{width:"100%",height:"120px",objectFit:"contain",marginBottom:"8px",borderRadius:"6px"},src:p.VY+e.image,alt:"product"}),(0,h.jsx)("h3",{className:m.A.invoicepopupname,style:{fontSize:"16px",fontWeight:"600",color:"#333"},children:e.name}),(0,h.jsxs)("h6",{children:[" ",e.quantity]})]},e.product_id)))}),(0,h.jsxs)("div",{className:"col-4 col-md-4 col-xl-3",style:{padding:"20px",background:"#f8f8f8",borderRadius:"8px",height:"inherit"},children:[(0,h.jsx)("h3",{style:I<500?{marginBottom:"16px",color:"#333",textAlign:"center",fontSize:"14px"}:{marginBottom:"16px",color:"#333",textAlign:"center"},children:"Selected Products"}),(0,h.jsx)("div",{style:{overflowY:"auto",maxHeight:"80%"},className:m.A.rmscroll,children:g.map((e=>(0,h.jsxs)("div",{style:I<500?{background:"#fff",marginBottom:"10px",padding:"10px",borderRadius:"6px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",cursor:"pointer",fontSize:"10px"}:{background:"#fff",marginBottom:"10px",padding:"10px",borderRadius:"6px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>(e=>{var t;f.setFieldsValue({count:e.count,customize:null===e||void 0===e?void 0:e.customize,price:e.price}),null===(t=_.current)||void 0===t||t.focus(),k(!0),S(e),A(!0),q((e=>!e))})(e),children:[(0,h.jsxs)("div",{children:[e.name," ",`(${e.quantity})`," x ",e.count," ",e.customize?`- ${e.customize}`:""]},e.id),(0,h.jsx)(u.QCr,{style:{cursor:"pointer"},onClick:t=>{t.stopPropagation(),i((t=>t.filter((t=>t.id!==e.id))))}})]})))}),(0,h.jsxs)("h6",{style:I<500?{color:"#333",textAlign:"end",fontSize:"13px",marginTop:"22px"}:{color:"#333",textAlign:"end",marginTop:"22px"},children:["Total:",g.reduce(((e,t)=>e+t.count*t.price),0).toFixed(2)]})]})]}),(0,h.jsx)(r.A,{title:C?`Edit ${null===z||void 0===z?void 0:z.name} (${null===z||void 0===z?void 0:z.quantity})`:`Customize ${null===z||void 0===z?void 0:z.name} (${null===z||void 0===z?void 0:z.quantity})`,visible:w,onCancel:()=>(A(!1),S({})),footer:null,children:z&&(0,h.jsxs)(n.A,{layout:"vertical",form:f,onFinish:e=>{const{count:t,customize:o,price:n}=e;i(C?e=>e.map((e=>e.id===z.id?{...e,count:t,customize:o,price:n}:e)):e=>[...e,{id:Date.now(),product_id:z.product_id,name:z.name,image:z.image,price:n,count:t,quantity:null===z||void 0===z?void 0:z.quantity,customize:o||""}]),A(!1),S({})},children:[(0,h.jsx)(n.A.Item,{label:"Quantity",name:"count",rules:[{required:!0,message:"Please enter a count"}],children:(0,h.jsx)(c.A,{ref:_,type:"number",min:1,style:{width:"100%"},autoFocus:!0})}),(0,h.jsx)(n.A.Item,{label:"Cutting size",name:"customize",children:(0,h.jsx)(d.A,{style:{width:"100%"},placeholder:"Select a cutting size",ref:D,onKeyDown:e=>((e,t)=>{var i;"Enter"===e.key&&(e.preventDefault(),null===t||void 0===t||null===(i=t.current)||void 0===i||i.focus())})(e,T),onChange:e=>{},children:N.map((e=>(0,h.jsx)(d.A.Option,{value:e.name,children:e.name},e.customization_id)))})}),(0,h.jsx)(n.A.Item,{label:"Price",name:"price",rules:[{required:!0,message:"Please enter a price"}],children:(0,h.jsx)(c.A,{min:1,type:"number",style:{width:"100%"},ref:T})}),(0,h.jsx)(a.Ay,{type:"primary",htmlType:"submit",block:!0,children:C?"Update Product":"Add to Item"})]})})]})}}}]);
//# sourceMappingURL=161.995c91d9.chunk.js.map